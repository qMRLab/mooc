{"version":1,"kind":"Notebook","sha256":"2a48de4401d21aaa08457ec67ba28c07890393bfdbc6c71dd97cceb2f1635a2a","slug":"flair-1","location":"/7 - Class Application Examples/1 T1 mapping/Notebooks/flair_1.ipynb","dependencies":[],"frontmatter":{"kernelspec":{"name":"python3","display_name":"mooc","language":"python"},"date":"2024-10-08","open_access":true,"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/qmrlab/mooc","subject":"mOOC","venue":{"title":"qMRLab"},"numbering":{"heading_1":{"enabled":true},"heading_2":{"enabled":true},"heading_3":{"enabled":true},"heading_4":{"enabled":true},"heading_5":{"enabled":true},"heading_6":{"enabled":true},"title":{"offset":1}},"keywords":["quantitative MRI","education"],"copyright":"NeuroPoly 2024","abbreviations":{"MRI":"Magnetic resonance imaging","MR":"Magnetic resonance","NMR":"Nuclear Magnetic Resonance","qMRI":"quantitative magnetic resonance imaging","GPT":"Generative Pre-trained Transformer","MRM":"Magnetic Resonance in Medicine","B0":"Main magnetic field","B1":"Radiofrequency field","FID":"Free Induction Decay","Gx":"X-axis gradient","Gy":"Y-axis gradient","Gz":"Z-axis gradient","TR":"Repetition Time","TE":"Echo Time","TI":"Inversion Time","CSF":"Cerebrospinal fluid","T1":"Longitudinal magnetization relaxation time constant","_T_{sub}`1`":"Longitudinal magnetization relaxation time constant","T2":"Transverse magnetization relaxation time constant","SE":"Spin Echo","GRE":"Gradient Echo","SPGR":"Spoiled Gradient Echo (sequence)","UMAP":"Uniform manifold approximation and projection","ADC":"Analog to digital converter","RF":"Radiofrequency","FA":"Flip Angle","VFA":"Variable Flip Angle","DESPOT1":"Driven Equilibrium Single Pulse Observation of _T_{sub}`1`","SNR":"Signal-to-noise ratio","RD-NLS":"reduced-dimension non-linear least-squares","STD":"Standard deviation","MT":"Magnetization Transfer","MTR":"Magnetization Transfer Ratio","MS":"Multiple Sclerosis","qMT":"Quantitative Magnetization Transfer","MTsat":"Magnetization Transfer saturation","SAR":"Specific absorption rate","FWHM":"Full width at half maximum"},"edit_url":"https://github.com/qmrlab/mooc/blob/mb/requirements/7 - Class Application Examples/1 T1 mapping/Notebooks/flair_1.ipynb","exports":[{"format":"ipynb","filename":"flair_1.ipynb","url":"/flair_1-f6726d4deda101726686fa8a4726e2fa.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"import nibabel as nib\nimport os\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# SPGR function\n\ndef spgr(constant, T1, T2, TR, TE, FA):\n    return (constant * ((1 - np.exp(-TR / T1)) / (1 - np.cos(FA) * np.exp(-TR / T1)))* np.sin(FA))*np.exp(-TE/T2)\n\ndef ir(constant, T1, T2, TR, TI, TE, FA):\n    return constant * ((1- np.cos(np.pi) * np.exp(-TR / T1)- (1 - np.cos(np.pi))* np.exp(-TI / T1))/ (1- np.cos(np.pi)* np.cos(FA)* np.exp(-TR / T1)))*np.sin(FA)*np.exp(-TE/T2)\n\nt1map = nib.load('../../data/07-Applications/FLAIR - T1 map.nii.gz').get_fdata()\n\n# Simulate a T2 map by dividing the T1 map by 10\nt2map = t1map / 10\n\n# Get all the (x, y) ints in a grid that fall within a circle int(5) diameter for a center at (112,163)\n#x, y = np.mgrid[:t1map.shape[0], :t1map.shape[1]]\n#mask = (x - 115)**2 + (y - 158)**2 < 2.6**2\nmask = nib.load('Mask.nii.gz').get_fdata()\nmask=np.squeeze(mask)\n# Introduce a circular lesion at 100 and 150\nt2map[mask!=0] = t2map[mask!=0]*2\nt1map[mask!=0] = t1map[mask!=0]*1.1\n\n# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTE = 150\nFA = 90\nt2w=spgr(1, t1map, t2map, TR, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(np.rot90(t2w),cmap='grey')\nplt.clim(0, 0.7)\nplt.colorbar()\nplt.show()\n","identifier":"flair1jn-code","enumerator":"1","html_id":"flair1jn-code","key":"keUoRGJeyF"},{"type":"output","id":"FwKd7tjCDbUYrudb2YU_m","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"7e1c5e8dcbb2ae9fdcdea03edeee11c3","path":"/7e1c5e8dcbb2ae9fdcdea03edeee11c3.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair1jn-output","html_id":"flair1jn-output","key":"Idw3kvDQrw"}],"identifier":"flair1jn","label":"flair1jn","html_id":"flair1jn","key":"vKKgZQ9PGX"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T1-weighted spgr image using the T1 and T2 values voxel-wise\nTR = 500\nTE = 15\nFA = 70\nt1w=spgr(1, t1map, t2map, TR, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(np.rot90(t1w),cmap='grey')\nplt.clim(0, 0.6)\nplt.colorbar()\nplt.show()","identifier":"flair2jn-code","enumerator":"2","html_id":"flair2jn-code","key":"blxy9oh7pK"},{"type":"output","id":"A14McIMfPxuVlL879Zju9","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"b1c7ba9f38b3019464b4083c9ad8aee8","path":"/b1c7ba9f38b3019464b4083c9ad8aee8.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair2jn-output","html_id":"flair2jn-output","key":"qmdCApK2Wp"}],"identifier":"flair2jn","label":"flair2jn","html_id":"flair2jn","key":"gYNFzs0zCM"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTI = 50\nTE = 15\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 1.5)\nplt.colorbar()\nplt.show()","identifier":"flair4ajn-code","enumerator":"3","html_id":"flair4ajn-code","key":"fN47NSdgVK"},{"type":"output","id":"BGaWC5GfS3NALLtrKDZ5L","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2ba6d759f2efa7225b4375475e3913f6","path":"/2ba6d759f2efa7225b4375475e3913f6.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair4ajn-output","html_id":"flair4ajn-output","key":"VbLObvX6b6"}],"identifier":"flair4ajn","label":"flair4ajn","html_id":"flair4ajn","key":"Fr2AxJHlKQ"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTI = 500\nTE = 15\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 1)\nplt.colorbar()\nplt.show()","identifier":"flair4bjn-code","enumerator":"4","html_id":"flair4bjn-code","key":"cl9XCwIWTE"},{"type":"output","id":"UDJwgmnfuqr1YBFr8gPsC","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eff78ce5aca3520b4e7a97fe66ad98e8","path":"/eff78ce5aca3520b4e7a97fe66ad98e8.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair4bjn-output","html_id":"flair4bjn-output","key":"iu6q6cjkCx"}],"identifier":"flair4bjn","label":"flair4bjn","html_id":"flair4bjn","key":"Yrv8jdy8BL"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTI = 1000\nTE = 15\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 1.2)\nplt.colorbar()\nplt.show()","identifier":"flair4cjn-code","enumerator":"5","html_id":"flair4cjn-code","key":"O9Wns9GGvA"},{"type":"output","id":"JFNYwlNEhb-Esfm5i2Ghh","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"8026fb205713b56e5d5f1b8aaef30831","path":"/8026fb205713b56e5d5f1b8aaef30831.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair4cjn-output","html_id":"flair4cjn-output","key":"x0PHpNOGt4"}],"identifier":"flair4cjn","label":"flair4cjn","html_id":"flair4cjn","key":"KCK4QDbTFw"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTI = 3000\nTE = 15\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 1.2)\nplt.colorbar()\nplt.show()","identifier":"flair4djn-code","enumerator":"6","html_id":"flair4djn-code","key":"SrSG2KvXKU"},{"type":"output","id":"_zgwQ6Neep7S4IxcLOG_A","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"a9da586306d3012a7cce8703a3bad129","path":"/a9da586306d3012a7cce8703a3bad129.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair4djn-output","html_id":"flair4djn-output","key":"Qw1Vqp5L4O"}],"identifier":"flair4djn","label":"flair4djn","html_id":"flair4djn","key":"ghCea0L3Lg"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 10000\nTI = 3000\nTE = 150\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 0.5)\nplt.colorbar()\nplt.show()","identifier":"flair5ajn-code","enumerator":"7","html_id":"flair5ajn-code","key":"rubop5Rkzw"},{"type":"output","id":"pazR4FiXgAyzk7y-764wx","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bb3a7030a11616fa906656e3801eedab","path":"/bb3a7030a11616fa906656e3801eedab.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair5ajn-output","html_id":"flair5ajn-output","key":"qDhV0KsOGq"}],"identifier":"flair5ajn","label":"flair5ajn","html_id":"flair5ajn","key":"rdqmLZ47Z4"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 5000\nTI = 3000\nTE = 15\nFA = 20\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 0.4)\nplt.colorbar()\nplt.show()","identifier":"flair5bjn-code","enumerator":"8","html_id":"flair5bjn-code","key":"HW8RkYA1v0"},{"type":"output","id":"uuHVDZjyePi3QImJTn-3k","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"512c20a640bd5187ea5eb441a6312500","path":"/512c20a640bd5187ea5eb441a6312500.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair5bjn-output","html_id":"flair5bjn-output","key":"WJqRKY7gAf"}],"identifier":"flair5bjn","label":"flair5bjn","html_id":"flair5bjn","key":"NeiDs2URes"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 1000\nTI = 3000\nTE = 120\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 0.5)\nplt.colorbar()\nplt.show()","identifier":"flair5cjn-code","enumerator":"9","html_id":"flair5cjn-code","key":"kWYWBKZLlG"},{"type":"output","id":"lsYJH23ccgds8SnZNmBIt","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"6774e070385c88fb6fc06b895630aa3b","path":"/6774e070385c88fb6fc06b895630aa3b.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair5cjn-output","html_id":"flair5cjn-output","key":"FWRZGrSMsE"}],"identifier":"flair5cjn","label":"flair5cjn","html_id":"flair5cjn","key":"nl7Hq2Hl0y"},{"type":"block","kind":"notebook-code","data":{},"children":[{"type":"code","lang":"python","executable":true,"value":"# Simulate a T2-weighted spgr image using the T1 and T2 values voxel-wise, TR = 4000 ms, TE = 100 ms, and FA = 90 degrees\nTR = 10000\nTI = 3100\nTE = 1\nFA = 90\n\nflair=ir(1, t1map, t2map, TR, TI, TE, np.deg2rad(FA))\n\n# Plot the T2-weighted spgr image in black and white\nplt.imshow(abs(np.rot90(flair)),cmap='gray')\nplt.clim(0, 1.2)\nplt.colorbar()\nplt.show()","identifier":"flair5djn-code","enumerator":"10","html_id":"flair5djn-code","key":"nqqlwl2gEs"},{"type":"output","id":"Nwhigl7K8tz_JR5OdNyEv","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"d7fe009b91e750dc69c4a8409b392a56","path":"/d7fe009b91e750dc69c4a8409b392a56.png"},"text/plain":{"content":"<Figure size 640x480 with 2 Axes>","content_type":"text/plain"}}}],"identifier":"flair5djn-output","html_id":"flair5djn-output","key":"nde43p2pDH"}],"identifier":"flair5djn","label":"flair5djn","html_id":"flair5djn","key":"INn1BasC5X"}],"key":"gremA3Nb8H"},"references":{"cite":{"order":[],"data":{}}}}